---
date: "2024-09-15"
title: "기술 블로그 템플릿화 프로젝트 0"
categories: ["blog_template"]
summary: "포스트와 템플릿을 분리하고, 템플릿을 여러 사용자에게 제공하여 그들이 독립적으로 포스트를 관리할 수 있도록 하는 템플릿화 작업을 시작하게 되었습니다."
thumbnail: "./thumbnail/blog.png"
---

# 기존 블로그 개발

저는 이전에 지인의 부탁으로 Gatsby와 React를 기반으로 개인 기술 블로그를 개발한 경험이 있습니다. Gatsby는 정적 사이트 생성에, React는 컴포넌트 기반 UI 관리에 적합하여 초기 블로그 개발을 효율적이고 빠르게 진행할 수 있었습니다.

<img width="500" alt="image" style="margin: 20px 0px" src="https://gist.github.com/user-attachments/assets/d93e7612-af30-43ac-9d45-33643da823d5">

하지만 블로그가 확장되고 관리해야 할 콘텐츠가 늘어나면서 포스트와 템플릿 코드가 **하나의 코드베이스**에서 관리되는 구조적 문제로 인해 확장성과 유지보수에 어려움이 발생하기 시작했습니다. 기술 자체는 문제가 없었지만, 템플릿과 포스트가 통합된 구조는 관리의 복잡성을 더했습니다. 이를 해결하기 위해 **코드베이스를 분리하는 템플릿화 작업**을 진행하게 되었습니다.

### 주요 문제점:

1. **포스트와 템플릿 코드 혼재**: 다른 사용자의 포스트 업데이트와 제가 수정한 템플릿 코드가 동일한 레포에서 관리되다 보니, 커밋 로그를 확인하거나 특정 커밋으로 리셋할 때 두 작업이 혼재되어 불편함이 있었고, 서로 다른 업데이트를 분리해 관리하기가 어려웠습니다.
2. **템플릿 재사용성 부족**: 제가 만든 템플릿을 다른 프로젝트(지인 블로그가 아닌 개인 블로그)에서도 사용하고 싶었지만, 포스트와 템플릿이 통합된 구조에서는 재사용에 한계가 있었습니다. 여러 사용자가 같은 템플릿을 사용하면서도 각자의 포스트는 독립적으로 관리할 수 있도록 템플릿과 포스트를 분리할 필요가 있었습니다.

# **템플릿화의 이점**

이러한 문제를 해결하기 위해 템플릿화 작업을 진행하며 얻을 수 있는 이점은 다음과 같습니다.

### 주요 이점:

1. **코드 관리의 명확성**: 포스트와 템플릿이 분리되어 각각 독립적으로 관리됩니다. 템플릿을 업데이트해도 포스트에 영향을 주지 않으며, 문제가 발생했을 때 빠르게 원인을 파악할 수 있어 유지보수가 용이합니다.
2. **템플릿의 공유와 재사용성**: 여러 프로젝트에서 동일한 템플릿을 쉽게 재사용할 수 있습니다. 동일한 템플릿을 기반으로 여러 사용자가 자신의 포스트를 관리할 수 있으며, 필요에 따라 템플릿을 업데이트하고 각 프로젝트에서 독립적으로 반영할 수 있습니다.
3. **사용자에게 독립된 작업 환경 제공**: 각 사용자는 템플릿을 사용해 자신의 포스트 콘텐츠만 관리할 수 있습니다. 블로그 템플릿과 포스트가 섞이지 않도록 구조가 명확히 구분되어, 여러 사용자가 같은 템플릿을 기반으로 독립적으로 작업할 수 있는 환경을 제공합니다.

# **템플릿화 과정**

문제 해결과 이점을 목표로 한 템플릿화 과정을 간략히 소개하겠습니다.

1. **Step 1: 기존 레포에서 템플릿 코드 분리하기**

   기존 블로그 레포에서 **UI 및 레이아웃 관련 템플릿 코드**를 분리해 독립적인 템플릿 레포를 생성했습니다. 이 작업은 커밋을 cherry-pick으로 선택해 필요한 부분만 가져오는 방식으로 진행했습니다.

   ```
   git cherry-pick <템플릿 관련 커밋 해시>
   ```

2. **Step 2: 템플릿을 서브모듈로 불러오고 포스트 레포에 배포되도록 설정하기**

   **Git 서브모듈**을 사용해 템플릿을 각 블로그 프로젝트에 쉽게 적용할 수 있도록 하고, gh-pages로 배포할 때 repo 옵션을 사용해 포스트 레포에 배포되도록 설정했습니다.

   ```
   git submodule add <템플릿 레포>
   ```

   ```
   gatsby build && gh-pages -d public -b main --repo <포스트 레포>
   ```

3. **Step 3: 커스텀 데이터 별도 파일로 분리**

   사용자별 커스텀 데이터를 별도의 파일로 분리해 템플릿과 포스트 데이터가 명확히 분리된 상태로 관리되도록 했습니다.

   ```
   <포스트 레포>/
   ├── <템플릿 레포>/ (서브모듈)
   ├── contents/ (사용자 포스트 관리)
   ├── static/ (사용자 이미지 관리)
   └── gatsby-meta-config.js (사용자 커스텀 데이터 관리)
   ```

4. **Step 4: 분리한 커스텀 데이터 템플릿 레포에 받아오기**
   커스텀 데이터를 받아와 템플릿 내에서 사용할 수 있도록 설정하고, gatsby-source-filesystem 플러그인을 사용하여 콘텐츠와 이미지 파일을 템플릿에서 접근할 수 있게 설정하였습니다.

   ```js
   // gatsby-config.js
   const metaConfig = require("../gatsby-meta-config");

   module.exports = {
     siteMetadata: metaConfig,
     plugins: [
       {
         resolve: `gatsby-source-filesystem`,
         options: {
           name: `contents`,
           path: `${__dirname}/../contents`,
         },
       },
       {
         resolve: `gatsby-source-filesystem`,
         options: {
           name: `images`,
           path: `${__dirname}/../static`,
         },
       },
       // ...
     ],
   };
   ```

5. **Step 5: 포스트 레포에서 템플릿 npm 스크립트 동작하도록 설정하기**

   포스트 레포에서 npm 스크립트를 사용하여 템플릿 레포의 설치, 실행, 배포 작업을 간편하게 처리할 수 있도록 설정해주었습니다.

   ```json
   {
     "scripts": {
       "install": "npm --prefix <템플릿 서브모듈 경로> install",
       "start": "npm --prefix <템플릿 서브모듈 경로> run start",
       "deploy": "npm --prefix <템플릿 서브모듈 경로> run deploy"
     }
   }
   ```

6. **Step 6: path 포함 경로 배포 처리**

   path를 포함한 경로에 배포 시 발생할 수 있는 문제를 해결하고, 다양한 환경에서 템플릿이 정상적으로 작동하도록 설정했습니다.

   ```js
   // gatsby-config.js

   module.exports = {
     pathPrefix: `/blog`,
     // ...
   };
   ```

   ```
   gatsby build --prefix-paths
   ```

# **마무리**

지금까지 템플릿화를 진행하게 된 이유와 그 과정에 대해 간략히 살펴보았습니다.

다음 포스트부터는 각 단계에서 겪은 시행착오를 하나씩 다뤄보겠습니다.
